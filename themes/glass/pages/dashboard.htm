title = "Dashboard"
url = "/dashboard"
layout = "default"
is_hidden = 0
==
<?php
use Illuminate\Support\Facades\Schema;

function onStart()
{
    $this['teachersReady'] = Schema::hasTable('latihan_teachers');

    if (!$this['teachersReady']) {
        $this['teacherStats'] = [
            'total' => 0,
            'active' => 0,
            'inactive' => 0,
        ];
        $this['recentTeachers'] = [];
        return;
    }

    $total = Db::table('latihan_teachers')->count();
    $active = Db::table('latihan_teachers')->where('is_active', 1)->count();
    $inactive = max(0, $total - $active);

    $this['teacherStats'] = compact('total', 'active', 'inactive');
    $this['recentTeachers'] = Db::table('latihan_teachers')->orderByDesc('id')->limit(5)->get();
}
?>
==
<div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-4">
  <div>
    <h3 class="fw-bold mb-1">Dashboard</h3>
    <p class="text-muted mb-0">Ringkasan data & akses cepat.</p>
  </div>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary" href="{{ 'teachers'|page }}">
      <i class="bi bi-people me-1"></i> Teachers
    </a>
    <a class="btn btn-primary" href="{{ 'teachers_create'|page }}">
      <i class="bi bi-plus-lg me-1"></i> Add Teacher
    </a>
  </div>
</div>

{% if not teachersReady %}
  <div class="alert alert-warning mb-4">
    Tabel <code>latihan_teachers</code> belum ada. Jalankan migration plugin <code>Latihan.Latihan</code> dulu.
  </div>
{% endif %}

<div class="row g-3 mb-4">
  <div class="col-md-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="text-muted">Total Teachers</div>
            <div class="fs-3 fw-bold">{{ teacherStats.total }}</div>
          </div>
          <div class="text-primary fs-2"><i class="bi bi-people"></i></div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="text-muted">Active</div>
            <div class="fs-3 fw-bold">{{ teacherStats.active }}</div>
          </div>
          <div class="text-success fs-2"><i class="bi bi-check-circle"></i></div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="text-muted">Inactive</div>
            <div class="fs-3 fw-bold">{{ teacherStats.inactive }}</div>
          </div>
          <div class="text-secondary fs-2"><i class="bi bi-slash-circle"></i></div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-header bg-white d-flex justify-content-between align-items-center">
    <div class="fw-semibold">Recent Teachers</div>
    <a class="btn btn-sm btn-outline-primary" href="{{ 'teachers'|page }}">View all</a>
  </div>
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table mb-0 align-middle">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th>Subject</th>
            <th>Status</th>
            <th class="text-end">Action</th>
          </tr>
        </thead>
        <tbody>
          {% if recentTeachers|length == 0 %}
            <tr>
              <td colspan="4" class="text-center text-muted py-4">Belum ada data.</td>
            </tr>
          {% endif %}
          {% for t in recentTeachers %}
            <tr>
              <td class="fw-semibold">{{ t.name }}</td>
              <td class="text-muted">{{ t.subject }}</td>
              <td>
                {% if t.is_active %}
                  <span class="badge text-bg-success">Active</span>
                {% else %}
                  <span class="badge text-bg-secondary">Inactive</span>
                {% endif %}
              </td>
              <td class="text-end">
                <a class="btn btn-sm btn-outline-secondary" href="{{ 'teachers_edit'|page({ id: t.id }) }}">
                  <i class="bi bi-pencil-square me-1"></i> Edit
                </a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
